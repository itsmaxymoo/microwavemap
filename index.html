---
head: |
  <link rel="stylesheet" href="/assets/leaflet/leaflet.css"
  integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=" crossorigin="" />
  <script src="/assets/leaflet/leaflet.js" integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="
  crossorigin=""></script>
---

<div id="microwave-map" style="height: 700px; width: 100%;"></div>

<script type="text/javascript">

	const mapDiv = document.getElementById("microwave-map");
	const initialLatLng = [40.800901, -77.86094];
	const initialZoom = 16;

	// Create map
	let map = L.map("microwave-map").setView(
		new L.LatLng(...initialLatLng),
		initialZoom
	);

	scaleMap();

	// Set tiles
	L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png", {
		maxZoom: 19,
		attribution:
			'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
	}).addTo(map);

	// Load map data
	fetch("{{ site.baseurl }}/locations.json")
		.then((response) => response.json())
		.then((json) => populateMap(json));

	window.onresize = () => {
		scaleMap();
	};


	// Function to properly scale map
	function scaleMap() {
		let usedHeight = 0;

		for (let i = 0; i < document.body.children.length; i++) {
			let child = document.body.children[i];

			if (child.id == "microwave-map") {
				continue;
			}

			usedHeight += child.clientHeight;
		}

		mapDiv.style.height = window.innerHeight - usedHeight + "px";
		map.invalidateSize();
	}


	// Function to load map data
	function populateMap(data) {
		data.forEach(element => {
			if(element.skip){
				return;
			}

			latLng = element.coords.split(/[\s,]+/);
			let iconFile = element.access + ".png";

			let marker = L.marker(new L.LatLng(...latLng), {
				icon: new L.Icon.Default({ iconUrl: iconFile, iconRetinaUrl: iconFile })
			});

			marker.addTo(map);
		});
	}

</script>